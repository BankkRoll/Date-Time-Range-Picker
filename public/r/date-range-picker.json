{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "date-range-picker",
  "type": "registry:component",
  "title": "Date Range Picker",
  "description": "A component for selecting a range of dates with presets.",
  "dependencies": [
    "date-fns",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "calendar",
    "label",
    "popover",
    "select",
    "switch"
  ],
  "files": [
    {
      "path": "registry/default/date-time-range-picker/date-range-picker.tsx",
      "content": "\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { CheckIcon, ChevronDownIcon } from \"lucide-react\";\r\nimport * as React from \"react\";\r\nimport { DateInput } from \"./date-input\";\r\n\r\nexport interface DateRange {\r\n  from: Date;\r\n  to: Date | undefined;\r\n}\r\n\r\ninterface Preset {\r\n  name: string;\r\n  label: string;\r\n}\r\n\r\nconst PRESETS: Preset[] = [\r\n  { name: \"today\", label: \"Today\" },\r\n  { name: \"yesterday\", label: \"Yesterday\" },\r\n  { name: \"last7\", label: \"Last 7 days\" },\r\n  { name: \"last14\", label: \"Last 14 days\" },\r\n  { name: \"last30\", label: \"Last 30 days\" },\r\n  { name: \"thisWeek\", label: \"This Week\" },\r\n  { name: \"lastWeek\", label: \"Last Week\" },\r\n  { name: \"thisMonth\", label: \"This Month\" },\r\n  { name: \"lastMonth\", label: \"Last Month\" },\r\n];\r\n\r\nexport interface DateRangePickerProps {\r\n  onUpdate?: (values: { range: DateRange }) => void;\r\n  initialDateFrom?: Date | string;\r\n  initialDateTo?: Date | string;\r\n  align?: \"start\" | \"center\" | \"end\";\r\n  locale?: string;\r\n  className?: string;\r\n}\r\n\r\nconst formatDate = (date: Date, locale = \"en-us\"): string => {\r\n  return date.toLocaleDateString(locale, {\r\n    month: \"short\",\r\n    day: \"numeric\",\r\n    year: \"numeric\",\r\n  });\r\n};\r\n\r\nconst getDateAdjustedForTimezone = (dateInput: Date | string): Date => {\r\n  if (typeof dateInput === \"string\") {\r\n    const parts = dateInput.split(\"-\").map((part) => Number.parseInt(part, 10));\r\n    return new Date(parts[0], parts[1] - 1, parts[2]);\r\n  }\r\n  return dateInput;\r\n};\r\n\r\nexport const DateRangePicker: React.FC<DateRangePickerProps> = ({\r\n  initialDateFrom = new Date(new Date().setHours(0, 0, 0, 0)),\r\n  initialDateTo,\r\n  onUpdate,\r\n  align = \"center\",\r\n  locale = \"en-US\",\r\n  className,\r\n}) => {\r\n  const [isOpen, setIsOpen] = React.useState(false);\r\n  const [range, setRange] = React.useState<DateRange>({\r\n    from: getDateAdjustedForTimezone(initialDateFrom),\r\n    to: initialDateTo\r\n      ? getDateAdjustedForTimezone(initialDateTo)\r\n      : getDateAdjustedForTimezone(initialDateFrom),\r\n  });\r\n\r\n  const openedRangeRef = React.useRef<DateRange>(range);\r\n  const [selectedPreset, setSelectedPreset] = React.useState<\r\n    string | undefined\r\n  >(undefined);\r\n  const [calendarMonths, setCalendarMonths] = React.useState<[Date, Date]>([\r\n    new Date(),\r\n    new Date(new Date().setMonth(new Date().getMonth() + 1)),\r\n  ]);\r\n\r\n  const getPresetRange = React.useCallback((presetName: string): DateRange => {\r\n    const now = new Date();\r\n    const today = new Date(now.setHours(0, 0, 0, 0));\r\n    const endToday = new Date(now.setHours(23, 59, 59, 999));\r\n\r\n    switch (presetName) {\r\n      case \"today\":\r\n        return { from: today, to: endToday };\r\n      case \"yesterday\": {\r\n        const yesterday = new Date(today);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        return {\r\n          from: yesterday,\r\n          to: new Date(yesterday.setHours(23, 59, 59, 999)),\r\n        };\r\n      }\r\n      case \"last7\":\r\n        return {\r\n          from: new Date(today.setDate(today.getDate() - 6)),\r\n          to: endToday,\r\n        };\r\n      case \"last14\":\r\n        return {\r\n          from: new Date(today.setDate(today.getDate() - 13)),\r\n          to: endToday,\r\n        };\r\n      case \"last30\":\r\n        return {\r\n          from: new Date(today.setDate(today.getDate() - 29)),\r\n          to: endToday,\r\n        };\r\n      case \"thisWeek\": {\r\n        const first = today.getDate() - today.getDay();\r\n        return { from: new Date(today.setDate(first)), to: endToday };\r\n      }\r\n      case \"lastWeek\": {\r\n        const first = today.getDate() - today.getDay() - 7;\r\n        const last = first + 6;\r\n        return {\r\n          from: new Date(today.setDate(first)),\r\n          to: new Date(today.setDate(last)),\r\n        };\r\n      }\r\n      case \"thisMonth\": {\r\n        return {\r\n          from: new Date(today.setDate(1)),\r\n          to: endToday,\r\n        };\r\n      }\r\n      case \"lastMonth\": {\r\n        const lastMonth = new Date(today.setMonth(today.getMonth() - 1));\r\n        return {\r\n          from: new Date(lastMonth.setDate(1)),\r\n          to: new Date(lastMonth.setDate(0)),\r\n        };\r\n      }\r\n      default:\r\n        throw new Error(`Unknown date range preset: ${presetName}`);\r\n    }\r\n  }, []);\r\n\r\n  const setPreset = (preset: string): void => {\r\n    const newRange = getPresetRange(preset);\r\n    setRange(newRange);\r\n    setSelectedPreset(preset);\r\n    if (newRange.from) {\r\n      setCalendarMonths([\r\n        newRange.from,\r\n        new Date(newRange.from.setMonth(newRange.from.getMonth() + 1)),\r\n      ]);\r\n    }\r\n  };\r\n\r\n  const checkPreset = React.useCallback(() => {\r\n    for (const preset of PRESETS) {\r\n      const presetRange = getPresetRange(preset.name);\r\n      if (\r\n        presetRange.from.getTime() === range.from.getTime() &&\r\n        presetRange.to?.getTime() === range.to?.getTime()\r\n      ) {\r\n        setSelectedPreset(preset.name);\r\n        return;\r\n      }\r\n    }\r\n    setSelectedPreset(undefined);\r\n  }, [range, getPresetRange]);\r\n\r\n  const resetValues = (): void => {\r\n    setRange({\r\n      from: getDateAdjustedForTimezone(initialDateFrom),\r\n      to: initialDateTo\r\n        ? getDateAdjustedForTimezone(initialDateTo)\r\n        : getDateAdjustedForTimezone(initialDateFrom),\r\n    });\r\n    setSelectedPreset(undefined);\r\n    setCalendarMonths([\r\n      new Date(),\r\n      new Date(new Date().setMonth(new Date().getMonth() + 1)),\r\n    ]);\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    checkPreset();\r\n  }, [checkPreset]);\r\n\r\n  const PresetButton = ({\r\n    preset,\r\n    label,\r\n    isSelected,\r\n  }: {\r\n    preset: string;\r\n    label: string;\r\n    isSelected: boolean;\r\n  }) => (\r\n    <Button\r\n      className={cn(\"justify-start\", isSelected && \"bg-muted\")}\r\n      variant=\"ghost\"\r\n      onClick={() => setPreset(preset)}\r\n    >\r\n      <CheckIcon\r\n        className={cn(\"mr-2 h-4 w-4\", isSelected ? \"opacity-100\" : \"opacity-0\")}\r\n      />\r\n      {label}\r\n    </Button>\r\n  );\r\n\r\n  const areRangesEqual = (a?: DateRange, b?: DateRange): boolean => {\r\n    if (!a || !b) return a === b;\r\n    return (\r\n      a.from.getTime() === b.from.getTime() &&\r\n      (!a.to || !b.to || a.to.getTime() === b.to.getTime())\r\n    );\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (isOpen) {\r\n      openedRangeRef.current = range;\r\n    }\r\n  }, [isOpen, range]);\r\n\r\n  return (\r\n    <Popover open={isOpen} onOpenChange={setIsOpen}>\r\n      <PopoverTrigger asChild>\r\n        <Button\r\n          variant=\"outline\"\r\n          className={cn(\r\n            \"w-full sm:w-[300px] justify-start text-left text-[11px] font-normal text-wrap\",\r\n            className,\r\n          )}\r\n        >\r\n          {formatDate(range.from, locale)}\r\n          {range.to && (\r\n            <>\r\n              <ChevronDownIcon className=\"mx-2 h-4 w-4\" />\r\n              {formatDate(range.to, locale)}\r\n            </>\r\n          )}\r\n        </Button>\r\n      </PopoverTrigger>\r\n      <PopoverContent className=\"w-auto p-0\" align={align} sideOffset={4}>\r\n        <div className=\"flex flex-col lg:flex-row gap-4 p-4\">\r\n          {/* Calendar Section */}\r\n          <div className=\"space-y-4\">\r\n            <div className=\"hidden lg:flex space-x-4\">\r\n              {/* Two calendars side by side for desktop */}\r\n              <Calendar\r\n                mode=\"range\"\r\n                selected={range}\r\n                onSelect={(newRange) =>\r\n                  newRange && setRange(newRange as DateRange)\r\n                }\r\n                month={calendarMonths[0]}\r\n                onMonthChange={(month) =>\r\n                  setCalendarMonths([\r\n                    month,\r\n                    new Date(month.setMonth(month.getMonth() + 1)),\r\n                  ])\r\n                }\r\n                className=\"border rounded-md\"\r\n              />\r\n              <Calendar\r\n                mode=\"range\"\r\n                selected={range}\r\n                onSelect={(newRange) =>\r\n                  newRange && setRange(newRange as DateRange)\r\n                }\r\n                month={calendarMonths[1]}\r\n                onMonthChange={(month) =>\r\n                  setCalendarMonths([\r\n                    new Date(month.setMonth(month.getMonth() - 1)),\r\n                    month,\r\n                  ])\r\n                }\r\n                className=\"border rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            {/* Single calendar for mobile */}\r\n            <div className=\"lg:hidden\">\r\n              <Calendar\r\n                mode=\"range\"\r\n                selected={range}\r\n                onSelect={(newRange) =>\r\n                  newRange && setRange(newRange as DateRange)\r\n                }\r\n                className=\"border rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex justify-between items-center\">\r\n              <DateInput\r\n                value={range.from}\r\n                onChange={(date) => {\r\n                  const toDate =\r\n                    range.to == null || date > range.to ? date : range.to;\r\n                  setRange((prevRange) => ({\r\n                    ...prevRange,\r\n                    from: date,\r\n                    to: toDate,\r\n                  }));\r\n                }}\r\n              />\r\n              <ChevronDownIcon className=\"mx-2 h-4 w-4\" />\r\n              <DateInput\r\n                value={range.to}\r\n                onChange={(date) => {\r\n                  const fromDate = date < range.from ? date : range.from;\r\n                  setRange((prevRange) => ({\r\n                    ...prevRange,\r\n                    from: fromDate,\r\n                    to: date,\r\n                  }));\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Presets Section */}\r\n          <div className=\"lg:border-l lg:pl-4 space-y-2\">\r\n            <h3 className=\"font-medium text-sm\">Presets</h3>\r\n            <div className=\"grid grid-cols-2 lg:grid-cols-1 gap-1\">\r\n              {PRESETS.map((preset) => (\r\n                <PresetButton\r\n                  key={preset.name}\r\n                  preset={preset.name}\r\n                  label={preset.label}\r\n                  isSelected={selectedPreset === preset.name}\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"flex items-center justify-end gap-2 p-4 border-t\">\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={() => {\r\n              setIsOpen(false);\r\n              resetValues();\r\n            }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              setIsOpen(false);\r\n              if (!areRangesEqual(range, openedRangeRef.current)) {\r\n                onUpdate?.({ range });\r\n              }\r\n            }}\r\n          >\r\n            Update\r\n          </Button>\r\n        </div>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nDateRangePicker.displayName = \"DateRangePicker\";\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/date-time-range-picker/date-input.tsx",
      "content": "\"use client\";\r\n\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport * as React from \"react\";\r\n\r\ninterface DateInputProps {\r\n  value?: Date;\r\n  onChange: (date: Date) => void;\r\n  disabled?: boolean;\r\n  className?: string;\r\n}\r\n\r\ninterface DateParts {\r\n  day: number;\r\n  month: number;\r\n  year: number;\r\n}\r\n\r\nconst DateInput: React.FC<DateInputProps> = ({\r\n  value,\r\n  onChange,\r\n  disabled = false,\r\n  className,\r\n}) => {\r\n  const [date, setDate] = React.useState<DateParts>(() => {\r\n    const d = value ? new Date(value) : new Date();\r\n    return {\r\n      day: d.getDate(),\r\n      month: d.getMonth() + 1,\r\n      year: d.getFullYear(),\r\n    };\r\n  });\r\n\r\n  const monthRef = React.useRef<HTMLInputElement | null>(null);\r\n  const dayRef = React.useRef<HTMLInputElement | null>(null);\r\n  const yearRef = React.useRef<HTMLInputElement | null>(null);\r\n\r\n  React.useEffect(() => {\r\n    const d = value ? new Date(value) : new Date();\r\n    setDate({\r\n      day: d.getDate(),\r\n      month: d.getMonth() + 1,\r\n      year: d.getFullYear(),\r\n    });\r\n  }, [value]);\r\n\r\n  const validateDate = (field: keyof DateParts, value: number): boolean => {\r\n    if (\r\n      (field === \"day\" && (value < 1 || value > 31)) ||\r\n      (field === \"month\" && (value < 1 || value > 12)) ||\r\n      (field === \"year\" && (value < 1000 || value > 9999))\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    const newDate = { ...date, [field]: value };\r\n    const d = new Date(newDate.year, newDate.month - 1, newDate.day);\r\n    return (\r\n      d.getFullYear() === newDate.year &&\r\n      d.getMonth() + 1 === newDate.month &&\r\n      d.getDate() === newDate.day\r\n    );\r\n  };\r\n\r\n  const handleInputChange =\r\n    (field: keyof DateParts) => (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      if (disabled) return;\r\n\r\n      const newValue = e.target.value ? Number(e.target.value) : \"\";\r\n      const isValid =\r\n        typeof newValue === \"number\" && validateDate(field, newValue);\r\n\r\n      const newDate = { ...date, [field]: newValue };\r\n      setDate(newDate);\r\n\r\n      if (isValid) {\r\n        onChange(new Date(newDate.year, newDate.month - 1, newDate.day));\r\n      }\r\n    };\r\n\r\n  const initialDate = React.useRef<DateParts>(date);\r\n\r\n  const handleBlur =\r\n    (field: keyof DateParts) =>\r\n    (e: React.FocusEvent<HTMLInputElement>): void => {\r\n      if (disabled) return;\r\n\r\n      if (!e.target.value) {\r\n        setDate(initialDate.current);\r\n        return;\r\n      }\r\n\r\n      const newValue = Number(e.target.value);\r\n      const isValid = validateDate(field, newValue);\r\n\r\n      if (!isValid) {\r\n        setDate(initialDate.current);\r\n      } else {\r\n        initialDate.current = { ...date, [field]: newValue };\r\n      }\r\n    };\r\n\r\n  const handleKeyDown =\r\n    (field: keyof DateParts) => (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n      if (disabled) return;\r\n\r\n      if (e.metaKey || e.ctrlKey) {\r\n        return;\r\n      }\r\n\r\n      if (\r\n        !/^[0-9]$/.test(e.key) &&\r\n        ![\r\n          \"ArrowUp\",\r\n          \"ArrowDown\",\r\n          \"ArrowLeft\",\r\n          \"ArrowRight\",\r\n          \"Delete\",\r\n          \"Tab\",\r\n          \"Backspace\",\r\n          \"Enter\",\r\n        ].includes(e.key)\r\n      ) {\r\n        e.preventDefault();\r\n        return;\r\n      }\r\n\r\n      if (e.key === \"ArrowUp\") {\r\n        e.preventDefault();\r\n        let newDate = { ...date };\r\n\r\n        if (field === \"day\") {\r\n          if (date[field] === new Date(date.year, date.month, 0).getDate()) {\r\n            newDate = { ...newDate, day: 1, month: (date.month % 12) + 1 };\r\n            if (newDate.month === 1) newDate.year += 1;\r\n          } else {\r\n            newDate.day += 1;\r\n          }\r\n        }\r\n\r\n        if (field === \"month\") {\r\n          if (date[field] === 12) {\r\n            newDate = { ...newDate, month: 1, year: date.year + 1 };\r\n          } else {\r\n            newDate.month += 1;\r\n          }\r\n        }\r\n\r\n        if (field === \"year\") {\r\n          newDate.year += 1;\r\n        }\r\n\r\n        setDate(newDate);\r\n        onChange(new Date(newDate.year, newDate.month - 1, newDate.day));\r\n      } else if (e.key === \"ArrowDown\") {\r\n        e.preventDefault();\r\n        let newDate = { ...date };\r\n\r\n        if (field === \"day\") {\r\n          if (date[field] === 1) {\r\n            newDate.month -= 1;\r\n            if (newDate.month === 0) {\r\n              newDate.month = 12;\r\n              newDate.year -= 1;\r\n            }\r\n            newDate.day = new Date(newDate.year, newDate.month, 0).getDate();\r\n          } else {\r\n            newDate.day -= 1;\r\n          }\r\n        }\r\n\r\n        if (field === \"month\") {\r\n          if (date[field] === 1) {\r\n            newDate = { ...newDate, month: 12, year: date.year - 1 };\r\n          } else {\r\n            newDate.month -= 1;\r\n          }\r\n        }\r\n\r\n        if (field === \"year\") {\r\n          newDate.year -= 1;\r\n        }\r\n\r\n        setDate(newDate);\r\n        onChange(new Date(newDate.year, newDate.month - 1, newDate.day));\r\n      }\r\n\r\n      if (e.key === \"ArrowRight\") {\r\n        if (\r\n          e.currentTarget.selectionStart === e.currentTarget.value.length ||\r\n          (e.currentTarget.selectionStart === 0 &&\r\n            e.currentTarget.selectionEnd === e.currentTarget.value.length)\r\n        ) {\r\n          e.preventDefault();\r\n          if (field === \"month\") dayRef.current?.focus();\r\n          if (field === \"day\") yearRef.current?.focus();\r\n        }\r\n      } else if (e.key === \"ArrowLeft\") {\r\n        if (\r\n          e.currentTarget.selectionStart === 0 ||\r\n          (e.currentTarget.selectionStart === 0 &&\r\n            e.currentTarget.selectionEnd === e.currentTarget.value.length)\r\n        ) {\r\n          e.preventDefault();\r\n          if (field === \"day\") monthRef.current?.focus();\r\n          if (field === \"year\") dayRef.current?.focus();\r\n        }\r\n      }\r\n    };\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"flex border rounded-lg items-center text-sm px-1\",\r\n        className,\r\n      )}\r\n    >\r\n      <Input\r\n        type=\"text\"\r\n        ref={monthRef}\r\n        max={12}\r\n        maxLength={2}\r\n        value={date.month.toString()}\r\n        onChange={handleInputChange(\"month\")}\r\n        onKeyDown={handleKeyDown(\"month\")}\r\n        onFocus={(e) => {\r\n          if (window.innerWidth > 1024) {\r\n            e.target.select();\r\n          }\r\n        }}\r\n        onBlur={handleBlur(\"month\")}\r\n        className=\"p-0 outline-none w-6 border-none text-center\"\r\n        placeholder=\"M\"\r\n        disabled={disabled}\r\n      />\r\n      <span className=\"opacity-20 -mx-px\">/</span>\r\n      <Input\r\n        type=\"text\"\r\n        ref={dayRef}\r\n        max={31}\r\n        maxLength={2}\r\n        value={date.day.toString()}\r\n        onChange={handleInputChange(\"day\")}\r\n        onKeyDown={handleKeyDown(\"day\")}\r\n        onFocus={(e) => {\r\n          if (window.innerWidth > 1024) {\r\n            e.target.select();\r\n          }\r\n        }}\r\n        onBlur={handleBlur(\"day\")}\r\n        className=\"p-0 outline-none w-7 border-none text-center\"\r\n        placeholder=\"D\"\r\n        disabled={disabled}\r\n      />\r\n      <span className=\"opacity-20 -mx-px\">/</span>\r\n      <Input\r\n        type=\"text\"\r\n        ref={yearRef}\r\n        max={9999}\r\n        maxLength={4}\r\n        value={date.year.toString()}\r\n        onChange={handleInputChange(\"year\")}\r\n        onKeyDown={handleKeyDown(\"year\")}\r\n        onFocus={(e) => {\r\n          if (window.innerWidth > 1024) {\r\n            e.target.select();\r\n          }\r\n        }}\r\n        onBlur={handleBlur(\"year\")}\r\n        className=\"p-0 outline-none w-12 border-none text-center\"\r\n        placeholder=\"YYYY\"\r\n        disabled={disabled}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nDateInput.displayName = \"DateInput\";\r\n\r\nexport { DateInput };\r\n",
      "type": "registry:component"
    }
  ]
}